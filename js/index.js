$(function(){$("#progressBar").css("width","70%");var e=$(".section"),t=$(".page"),a=$(".asideNav"),n=$(".aside"),i=$(".asideOpen"),s=$(".music"),o=$(".sectionABox"),c=window.innerHeight,l=1,r=e.length;smallScreen=false;e.css("height",c+"px");a[0].style.marginTop=-a[0].offsetHeight/2+"px";i[0].style.marginTop=-a[0].offsetHeight/2-50+"px";s[0].style.top=a[0].offsetHeight/2+c/2+50+"px";t.append(e.find(".fullScreen")).append(e.first().clone(true));if(window.innerWidth<950){smallScreen=true}var d={$liPointer:$(".liPointer"),scrolling:false,backCalling:false,touchClientY:0,touchTime:null,down:function(){l+=1;d.move(l)},up:function(){if(l-1>0){l-=1;d.move(l)}},move:function(e,a){d.backCalling=true,d.scrolling=true;var n=-(e-1)*c+"px";if(a){t.css("transition-duration","0s").css("transform","translateY("+n+")");d.$liPointer.css("transition-duration","0s").css("top",(e-1)*30+"px");d.scrolling=false}else{d.$liPointer.css("transition-duration","1s");t.css("transition-duration","1s").css("transform","translateY("+n+")");if(e>r){d.$liPointer.css("top","0px")}else{d.$liPointer.css("top",(e-1)*30+"px")}}},moveEnd:function(){if(l>r){t.css("transition-duration","0s").css("transform","translateY(0px)");l=1}d.scrolling=false;d.backCall()},backCall:function(){if(d.backCalling){d.backCalling=false;d.backCallFn(l)}},backCallFn:function(e){switch(e){case 1:break;case 2:var t=$(".sectionBBtnNext");$(".sectionBBoxA .sectionBText").animate({marginTop:"10%",opacity:"1"},800,function(){if(t.attr("data-ok")!="ok"){t.animate({right:"3%",opacity:"1"}).attr("data-ok","ok")}});break;case 3:$(".sectionCBtn").addClass("rollIn");$(".sectionCBoxA .sectionCText").delay(300).animate({opacity:"1"},500);break;case 4:$(".sectionDBoxA .sectionDText").animate({opacity:"1",marginTop:"25%"},500);break;case 5:break}},mousewheelEvent:function(e){if(d.scrolling)return false;var t=e.wheelDelta||-e.detail;if(t>0){d.up()}else if(t<0){d.down()}},keyboardEvent:function(e){var t=e.keyCode;switch(t){case 37:d.up();break;case 38:d.up();break;case 39:d.down();break;case 40:d.down();break;case 32:h.click();break}},touchstartEvent:function(e){d.touchClientY=e.touches[0].clientY;d.touchTime=new Date;e.preventDefault()},touchendEvent:function(e){var t=e.changedTouches[0].clientY-d.touchClientY,a=new Date,n=a.getTime()-d.touchTime.getTime();if(t>70&&n<700){d.up()}else if(t<-70&&n<700){d.down()}d.touchClientY=0;d.touchTime=null;e.preventDefault()},liClickEvent:function(){l=parseInt(this.getAttribute("data-index"));d.move(l)},resizeEvent:function(){$(".music")[0].style.top=a[0].offsetHeight/2+window.innerHeight/2+50+"px";if(c!=window.innerHeight){c=window.innerHeight;$(".section").css("height",c+"px");d.move(l,true)}$(".sectionALine").css("right","15%").css("top","10%")},isFirefox:function(){var e=navigator.userAgent;if(e.indexOf("Firefox")>-1){return true}else{return false}}};if(d.isFirefox()){document.addEventListener("DOMMouseScroll",d.mousewheelEvent)}else{document.addEventListener("mousewheel",d.mousewheelEvent)}$("li").click(d.liClickEvent);t[0].addEventListener("touchstart",d.touchstartEvent);t[0].addEventListener("touchend",d.touchendEvent);$(window).keydown(d.keyboardEvent);t[0].addEventListener("webkitTransitionEnd",d.moveEnd);window.addEventListener("resize",d.resizeEvent);var f={transitting:false,$box:$(".textBox"),$point:$(".textBox .point"),transit:function(){if(f.transitting){return false}f.transitting=true;i.css("transition","all ease 0.5s");f.changeStyle()},changeStyle:function(){if(i.html()=="☆"){i.css("transform","rotate(360deg)").html("★");n.addClass("asideFixed");$(".aside ul,.asideOpen").addClass("asideColorFixed");$(".asideTitle").addClass("asideTitleFixed");s.addClass("asideMusicCenter");$(".textBox").addClass("textBoxShow").removeClass("textBoxHide");f.mainTextChange()}else{$(".textBox").addClass("textBoxHide").removeClass("textBoxShow");i.css("transform","rotate(0deg)").html("☆");n.removeClass("asideFixed");$(".aside ul,.asideOpen").removeClass("asideColorFixed");$(".asideTitle").removeClass("asideTitleFixed");s.removeClass("asideMusicCenter");f.mainTextBack()}},mainTextChange:function(){$(".sectionBText,.sectionCText,.sectionDText").each(function(){if(parseInt($(this).css("marginLeft"))<300){$(this).addClass("whenAsideOpen1")}});$(".sectionE .box").addClass("whenAsideOpen2")},mainTextBack:function(){$(".sectionBText,.sectionCText,.sectionDText").removeClass("whenAsideOpen1");$(".sectionE .box").removeClass("whenAsideOpen2")},transitEnd:function(){f.transitting=false},pointClick:function(){var e=$(this).attr("data-index"),t=$(".aside .textBox").attr("data-index");if(t=="A"){if(e=="A"){f.$box.attr("class","textBox textBoxShow Aup").attr("data-index","B")}else{if(f.$box.hasClass("Ashake")){f.$box.attr("class","textBox textBoxShow AshakeToo")}else{f.$box.attr("class","textBox textBoxShow Ashake")}}}else if(t=="B"){if(e=="A"){f.$box.attr("class","textBox textBoxShow Adown").attr("data-index","A")}else if(e=="B"){if(f.$box.hasClass("Bshake")){f.$box.attr("class","textBox textBoxShow BshakeToo")}else{f.$box.attr("class","textBox textBoxShow Bshake")}}else if(e=="C"){f.$box.attr("class","textBox textBoxShow Cdown").attr("data-index","C")}}else if(t=="C"){if(e=="C"){f.$box.attr("class","textBox textBoxShow Cup").attr("data-index","B")}else{if(f.$box.hasClass("Cshake")){f.$box.attr("class","textBox textBoxShow CshakeToo")}else{f.$box.attr("class","textBox textBoxShow Cshake")}}}e=$(this).attr("data-index");t=$(".aside .textBox").attr("data-index")}};i.click(f.transit);i[0].addEventListener("webkitTransitionEnd",f.transitEnd);f.$point.click(f.pointClick);var u={isFullScreen:false,fullScreen:function(){u.isFullScreen=true;var e=document.documentElement;if(window.ActiveXObject){var t=new ActiveXObject("WScript.Shell");t.SendKeys("{F11}")}else if(e.requestFullScreen){e.requestFullScreen()}else if(e.msRequestFullscreen){e.msRequestFullscreen()}else if(e.webkitRequestFullScreen){e.webkitRequestFullScreen()}else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}},fullExit:function(){u.isFullScreen=false;var e=document.documentElement;if(window.ActiveXObject){var t=new ActiveXObject("WScript.Shell");t.SendKeys("{F11}")}else if(e.requestFullScreen){document.exitFullscreen()}else if(e.msRequestFullscreen){document.msExitFullscreen()}else if(e.webkitRequestFullScreen){document.webkitCancelFullScreen()}else if(e.mozRequestFullScreen){document.mozCancelFullScreen()}},fullClickEvent:function(){if(u.isFullScreen){u.fullExit();$(this).html("<span>☒</span>全屏浏览")}else{u.fullScreen();$(this).html("<span>×</span>退出全屏")}}};$(".fullScreen p").click(u.fullClickEvent);var x={$Line:$(".sectionALine"),active:function(){x.$Line.animate({top:"10%"},500,function(){$(".sectionATitle").addClass("translateIn");$(".sectionAText").addClass("translateIn")})},mousemoveEvent:function(){var e=window.innerWidth,t=window.innerHeight,a=-(event.pageX-e/2)*10/e-.02*e,n=-(event.pageY-t/2)*10/t-.02*t;o.css("left",a+"px").css("top",n+"px");var i=-(event.pageX-e/2)*20/e+.15*e,s=-(event.pageY-t/2)*15/t+.1*t;x.$Line.css("right",i+"px").css("top",s+"px");event.preventDefault()}};x.active();o.mousemove(x.mousemoveEvent);var h={$btn:$(".music .button"),playing:false,click:function(){if(h.playing){h.stop()}else{h.play()}},play:function(){h.$btn.addClass("buttonPlay");$(".music .musicImg").addClass("play").css("animation-play-state","running");$(".music .ball-scale").fadeIn(1e3);$(".playing").fadeIn(1e3);$(".music audio")[0].play();if(smallScreen){setTimeout(function(){h.in()},600)}h.playing=true},stop:function(){h.$btn.removeClass("buttonPlay");$(".music .musicImg").removeClass("play").css("animation-play-state","paused");$(".music .ball-scale").fadeOut();$(".playing").fadeOut();$(".music audio")[0].pause();if(smallScreen){setTimeout(function(){h.in()},600)}h.playing=false},loading:function(){$("audio").html("<source src='music/Preparation.ogg' type='audio/ogg'><source src='music/Preparation.mp3' type='audio/mpeg'>")},out:function(){s.animate({left:"0"},200);h.$btn.addClass("block")},in:function(){s.animate({left:"-75px"},500,function(){h.$btn.removeClass("block")})}};h.loading();h.$btn.click(h.click);if(smallScreen){s.click(h.out)}var m={$text:$(".sectionBText"),$pageA:$(".sectionBBoxA"),$pageB:$(".sectionBBoxB"),$pageC:$(".sectionBBoxC"),$btnNext:$(".sectionBBtnNext"),$btnBefore:$(".sectionBBtnBefore"),$btnNextPage:$(".sectionBBtnNextPage"),index:1,changeing:false,pageChangeing:false,textChange:function(){if(!m.changeing){m.changeing=true;var e=$(this),t=e.find(".chs"),a=e.find(".en"),n=t[0].offsetHeight;if(t[0].style.opacity!=="0"){t.animate({top:-n/2+"px",opacity:"0.3"},700);a.animate({top:n/2+"px",opacity:"0.3"},700,function(){t.animate({top:"0px",opacity:"0"},700);a.animate({top:"0px",opacity:"1"},700,function(){m.changeing=false})})}else{a.animate({top:-n/2+"px",opacity:"0.3"},700);t.animate({top:n/2+"px",opacity:"0.3"},700,function(){a.animate({top:"0px",opacity:"0"},700);t.animate({top:"0px",opacity:"1"},700,function(){m.changeing=false})})}}},clickNext:function(){if(!m.pageChangeing){if(m.index==1){m.index=2;m.change(m.$pageA,m.$pageB,true);m.$btnBefore.delay(800).animate({right:"3%",opacity:"1"},function(){$(".sectionBBoxB .sectionBText ").animate({opacity:"1",marginTop:"7%"},800)})}else if(m.index==2){m.index=3;m.change(m.$pageB,m.$pageC,true);m.$btnNext.delay(1e3).animate({right:"-80px",opacity:"0"},function(){$(".sectionBBoxC .sectionBText ").animate({opacity:"1",marginTop:"4%"},800)});m.$btnBefore.delay(1e3).animate({top:"-=70px"});m.$btnNextPage.delay(1e3).animate({right:"3%",opacity:"1"})}}},clickBefore:function(){if(!m.pageChangeing){if(m.index==3){m.index=2;m.change(m.$pageC,m.$pageB,false);m.$btnNext.delay(1e3).animate({right:"3%",opacity:"1"});m.$btnBefore.delay(1e3).animate({top:"+=70px"});m.$btnNextPage.delay(1e3).animate({right:"-80px",opacity:"0"})}else if(m.index==2){m.index=1;m.change(m.$pageB,m.$pageA,false);m.$btnBefore.delay(1e3).animate({right:"-80px",opacity:"0"})}}},change:function(e,t,a){m.pageChangeing=true;var n=setInterval(function(){if(m.check(t)){m.pageChangeing=false;clearInterval(n)}},200);if(a){e.removeClass("boxLeftIn").removeClass("boxRightIn").addClass("boxLeftOut");t.removeClass("boxLeftOut").removeClass("boxRightOut").addClass("boxRightIn")}else{e.removeClass("boxLeftIn").removeClass("boxRightIn").addClass("boxRightOut");t.removeClass("boxLeftOut").removeClass("boxRightOut").addClass("boxLeftIn")}},check:function(e){if(e.css("z-index")=="900"){return true}else{return false}}};m.$text.click(m.textChange);var p=document.querySelectorAll(".sectionBText");for(var g=0;g<p.length;g++){p[g].addEventListener("touchstart",m.textChange)}m.$btnNext.click(m.clickNext);m.$btnNext[0].addEventListener("touchstart",m.clickNext);m.$btnBefore.click(m.clickBefore);m.$btnBefore[0].addEventListener("touchstart",m.clickBefore);m.$btnNextPage.click(d.down);m.$btnNextPage[0].addEventListener("touchstart",d.down);var C={$text:$(".sectionCText"),$btnNext:$(".sectionCBtnNext"),$btnBack:$(".sectionCBtnBack"),index:1,arr:["A","B","C","D","E","F"],changeing:false,textChange:function(){var e=$(this).find(".chs"),t=$(this).find(".en");if(e.attr("data-hide")!=="0"){e.addClass("opacityHide").removeClass("opacityShow").attr("data-hide","0");t.addClass("opacityShow").removeClass("opacityHide")}else{e.addClass("opacityShow").removeClass("opacityHide").attr("data-hide","1");t.addClass("opacityHide").removeClass("opacityShow")}},next:function(){if(!C.changeing){if(C.index+1<=6){C.index+=1;C.move(C.index,true)}else{d.down()}}},before:function(){if(!C.changeing){if(C.index-1>=1){C.index-=1;C.move(C.index,false)}}},move:function(e,t){C.changeing=true;var a=$(".sectionCBox"+C.arr[e-1]);var n=setInterval(function(){if(C.check(a)){C.changeing=false;clearInterval(n)}},200);if(t){$(".sectionCBox"+C.arr[e-2]).addClass("scaleLeftOut").removeClass("scaleLeftIn").removeClass("scaleRightIn");a.addClass("scaleRightIn").removeClass("scaleLeftOut").removeClass("scaleRightOut").children().delay(800).animate({opacity:"1"},500);if(e==2){C.$btnBack.addClass("backShow").removeClass("backHide").removeClass("hide")}else if(e==6){C.$btnNext.addClass("nextHide").removeClass("nextShow")}}else{$(".sectionCBox"+C.arr[e]).addClass("scaleRightOut").removeClass("scaleLeftIn").removeClass("scaleRightIn");a.addClass("scaleLeftIn").removeClass("scaleLeftOut").removeClass("scaleRightOut");if(e==5){C.$btnNext.addClass("nextShow").removeClass("nextHide")}else if(e==1){C.$btnBack.addClass("backHide").removeClass("backShow")}}},check:function(e){if(e.css("z-index")=="auto"){return true}else{return false}}};C.$text.click(C.textChange);var v=document.querySelectorAll(".sectionCText");for(var g=0;g<v.length;g++){v[g].addEventListener("touchstart",C.textChange)}C.$btnNext.click(C.next);C.$btnNext[0].addEventListener("touchstart",C.next);C.$btnBack.click(C.before);C.$btnBack[0].addEventListener("touchstart",C.before);var b={$btnNext:$(".sectionDBtnNext"),$btnBack:$(".sectionDBtnBack"),index:1,arr:["A","B","C","D","E"],changeing:false,textChange:function(){var e=$(this).find(".chs"),t=$(this).find(".en");if(e.attr("data-hide")!=="0"){e.addClass("rotateTranslateHide").removeClass("rotateTranslateShow").attr("data-hide","0");t.addClass("rotateTranslateShow").removeClass("rotateTranslateHide")}else{t.addClass("rotateTranslateHide").removeClass("rotateTranslateShow");e.addClass("rotateTranslateShow").removeClass("rotateTranslateHide").attr("data-hide","1")}},next:function(){if(!b.changeing){if(b.index+1<=5){b.index+=1;b.move(b.index,true)}}},before:function(){if(!b.changeing){if(b.index-1>=1){b.index-=1;b.move(b.index,false)}}},move:function(e,t){b.changeing=true;var a=$(".sectionDBox"+b.arr[e-1]);var n=setInterval(function(){if(b.check(a)){b.changeing=false;clearInterval(n)}},200);if(t){$(".sectionDBox"+b.arr[e-2]).addClass("shrinkHide").removeClass("shrinkShow");a.addClass("shrinkShow").removeClass("shrinkHide");b.textShow(a);if(e==2){b.$btnBack.addClass("shake").animate({opacity:1},800,function(){$(this).delay(1e3).removeClass("shake")})}else if(e==5){b.$btnNext.addClass("shake").delay(600).animate({opacity:0},800,function(){$(this).removeClass("shake")})}}else{var a=$(".sectionDBox"+b.arr[e-1]);$(".sectionDBox"+b.arr[e]).addClass("shrinkHide").removeClass("shrinkShow");a.addClass("shrinkShow").removeClass("shrinkHide");b.textShow(a);if(e==4){b.$btnNext.addClass("shake").animate({opacity:1},800,function(){$(this).delay(1e3).removeClass("shake")})}else if(e==1){b.$btnBack.addClass("shake").delay(600).animate({opacity:0},800,function(){$(this).removeClass("shake")})}}},check:function(e){if(e.css("z-index")=="auto"){return true}else{return false}},textShow:function(e){e.children().css("opacity","0").delay(2e3).addClass("scaleRotate").animate({opacity:1},800,function(){$(this).delay(1e3).removeClass("scaleRotate")})}};b.$btnNext.click(b.next);b.$btnNext[0].addEventListener("touchstart",b.next);b.$btnBack.click(b.before);b.$btnBack[0].addEventListener("touchstart",b.before);var k=document.querySelectorAll(".sectionDText");for(var g=0;g<k.length;g++){k[g].addEventListener("touchstart",b.textChange);k[g].addEventListener("click",b.textChange)}$(".wechat").click(function(){$(".QR").fadeToggle()});if(window.innerWidth<950){}$("#progressBar").css("width","100%");$("#progressMask").fadeOut(200)});